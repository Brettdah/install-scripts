---
- name: add docker repository GPG key
  apt_key: keyserver="{{ docker_apt_keyserver }}" id="{{ docker_apt_key_id }}"
  when: ansible_lsb.id == 'Debian' or ansible_lsb.id == 'Ubuntu'

- name: add docker main repository
  apt_repository: repo='deb {{ docker_apt_url }} {{ ansible_lsb.id|lower }}-{{ ansible_lsb.codename|lower }} main' state=present
  when: ansible_lsb.id == 'Debian' or ansible_lsb.id == 'Ubuntu'
  register: docker_apt_result

- name: apt update list for new docker repository
  apt: update_cache=yes
  when: docker_apt_result.changed

- name: install docker dependencies
  apt: name={{ item }} state=present
  with_items:
  - acl
  - cgroup-lite
  - apparmor

- name: install docker engine
  apt: name=docker-engine state={{ docker_state}}
